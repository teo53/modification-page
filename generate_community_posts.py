# -*- coding: utf-8 -*-
"""
커뮤니티 게시글 대량 생성 스크립트
queenalba.net 스타일을 참고하여 자연스러운 유저 글 생성
"""

import requests
import random
import time

# 설정
API_BASE_URL = 'http://127.0.0.1:4001/api/v1'
ADMIN_EMAIL = 'admin@lunaalba.com'
ADMIN_PASSWORD = 'admin1234'

# 카테고리 매핑 (프론트엔드 -> 백엔드 DTO)
CATEGORY_MAP = {
    '자유게시판': 'FREE',
    '질문답변': 'QNA',
    '업소후기': 'REVIEW',
    '지역정보': 'TIP',
    '구인구직': 'NEWS'
}

# 닉네임 패턴 (1-3글자, 초성, 이모티콘)
AUTHOR_NAMES = [
    "ㅇ", "ㅎ", "루루", "다라", "샴", "민지", "언니들", "ㅁㅁ", "ㅜㅜ", "솔솔",
    "달빛", "쏘야", "코코", "나나", "미미", "쁘띠", "봄날", "하늘", "별이", "수야"
]

# ============================================================
# 자유게시판 (FREE) - 일상, 고민, 인사
# ============================================================
FREE_POSTS = [
    {"title": "오늘 첫 출근인데 너무 떨려요ㅠㅠ", "content": "언니들 안녕하세요! 오늘 처음으로 출근하는 신입인데요,, 긴장돼서 잠을 못잤어요ㅠ 혹시 첫날 팁 같은 거 있으면 알려주세요🙏 화장은 진하게 해야 하나요?"},
    {"title": "퇴근하고 맥주 한잔 하고 싶다", "content": "아 오늘 진짜 힘들었어요... 손님이 유난히 많았는데 다들 어떻게 버티시나요?ㅋㅋ 퇴근하면 치맥각이에요🍺"},
    {"title": "다들 주말에 뭐하세요?", "content": "저는 주말에 쉬는데 집에만 있으니까 심심하네요... 언니들은 쉬는 날 뭐하고 지내세요? 취미같은거 있으면 추천해주세요!"},
    {"title": "비오는 날은 손님이 없네요", "content": "오늘 비가 많이 와서 손님이 거의 없어요ㅠ 이런 날은 걍 집에 있고 싶은데... 다들 화이팅하세요!"},
    {"title": "네일아트 새로 했는데 예쁜가요?", "content": "오늘 네일샵 가서 새로 받았어요! 글리터 넣었는데 너무 튀나요? 조언 부탁드려요💅"},
    {"title": "다이어트 해야되는데 야식이 땡기네요", "content": "진짜 살 빼야되는데 퇴근하면 너무 배고파서... 언니들 다이어트 비법 있어요? 저 의지가 너무 약해요ㅋㅋㅋ"},
    {"title": "오늘 날씨 진짜 좋네요 다들 화이팅!", "content": "날씨가 너무 좋아서 기분이 좋아요☀️ 오늘도 다들 파이팅하시고 좋은 일만 있으시길!"},
    {"title": "머리 스타일 바꿨는데 어때요?", "content": "레이어드컷으로 바꿨는데 괜찮은가요? 손님들한테 더 잘 보이고 싶어서요ㅎㅎ"},
    {"title": "요즘 넷플릭스 뭐 보세요?", "content": "출근 전에 심심해서 넷플릭스 보는데 볼게 없어요ㅠ 언니들 추천작 있으면 알려주세요!"},
    {"title": "가을이라 그런가 감성적이네요", "content": "요즘 날씨가 선선해지니까 괜히 감성적이 되네요... 혼자 있으면 생각이 많아져요ㅠ"},
    {"title": "오늘 대박 사건 있었어요ㅋㅋㅋ", "content": "아 진짜 오늘 웃긴 일 있었는데요ㅋㅋㅋ 나중에 풀게요 지금은 힘들어서..."},
    {"title": "다들 커피 어디서 사 드세요?", "content": "출근 전에 항상 커피 마시는데 추천할 만한 곳 있나요? 저는 스벅 자주 가는데 질려서요ㅎㅎ"},
    {"title": "강아지 영상 보면서 힐링해요", "content": "요즘 스트레스 받을 때 강아지 영상 보면 진짜 힐링돼요🐶 다들 뭐 보면서 힐링하세요?"},
    {"title": "언니들 다 예쁘시네요", "content": "커뮤니티 보면서 느끼는건데 다들 자기관리 잘하시는 것 같아요! 저도 열심히 해야겠어요💪"},
    {"title": "오늘 팁 받았어요!", "content": "오늘 손님이 팁을 주셨어요! 기분 좋게 퇴근합니다ㅎㅎ 다들 좋은 밤 되세요~"},
]

# ============================================================
# 질문답변 (QNA) - 업계 관련 질문
# ============================================================
QNA_POSTS = [
    {"title": "첫 출근 복장 질문드려요", "content": "다음주에 첫 출근인데 복장을 어떻게 해야할지 모르겠어요ㅠ 원피스? 정장? 언니들은 첫날 어떻게 입고 가셨나요?"},
    {"title": "급여 정산 어떻게 받으시나요?", "content": "혹시 급여는 어떻게 받으세요? 당일 지급인지 월급인지... 그리고 세금은 어떻게 처리하시는지 궁금해요!"},
    {"title": "진상 손님 대처법 좀 알려주세요ㅠㅠ", "content": "어제 진상 손님 만났는데 너무 당황해서 아무 말도 못했어요... 언니들은 이런 상황에서 어떻게 하세요?"},
    {"title": "면접 때 뭐 물어보나요?", "content": "다음주에 면접 보러 가는데 보통 뭐 물어보나요? 준비해야 할 거 있으면 알려주세요🙏"},
    {"title": "초보인데 할 수 있을까요?", "content": "이쪽 일 처음인데 저 같은 초보도 할 수 있을까요? 경력 없어도 괜찮은 곳 있나요?"},
    {"title": "술 못 마셔도 괜찮나요?", "content": "저 술을 잘 못 마시는데... 꼭 마셔야 하나요? 술 안 마시고도 할 수 있는 곳 있을까요?"},
    {"title": "텃세 심한가요?", "content": "새로 가게 옮기려고 하는데 텃세가 심하다고 들었어요ㅠ 실제로 어떤가요?"},
    {"title": "당일 지급 가능한 곳 있나요?", "content": "급하게 돈이 필요해서요... 당일 지급되는 곳 있으면 추천 부탁드려요!"},
    {"title": "지각하면 벌금 있나요?", "content": "혹시 지각하면 벌금 같은 거 있나요? 규정이 궁금해요..."},
    {"title": "강남 쪽 괜찮은 곳 추천해주세요", "content": "강남 쪽으로 옮기려고 하는데 추천할 만한 곳 있으면 알려주세요! 조건 좋은 곳으로요"},
    {"title": "친구랑 같이 가도 되나요?", "content": "친구랑 같이 일하고 싶은데 같이 구해주는 곳 있나요? 혼자 가기 무서워서요ㅠ"},
    {"title": "실장님 연락이 안돼요", "content": "면접 보기로 했는데 실장님 연락이 안 돼요... 이런 경우 어떻게 해야 하나요?"},
    {"title": "문신 있으면 안 되나요?", "content": "팔에 작은 문신이 있는데 이거 있으면 안 받아주나요? 가리면 되나요?"},
    {"title": "나이 많아도 괜찮을까요?", "content": "30대 초반인데 너무 늦은건 아닌지... 언니들 중 비슷한 분 계시면 조언 부탁드려요!"},
    {"title": "업종 변경 고민이에요", "content": "지금 하는 일이랑 다른 업종으로 옮기려고 하는데 어떻게 생각하세요? 경험 있으신 분?"},
]

# ============================================================
# 업소후기 (REVIEW) - 가게 후기
# ============================================================
REVIEW_POSTS = [
    {"title": "강남 ㅇㅇ 다녀왔는데 괜찮았어요", "content": "어제 강남 ㅇㅇ 다녀왔는데 분위기 좋고 언니들도 친절하더라구요! 실장님도 잘 케어해주시고 추천해요👍"},
    {"title": "역삼 ㅁㅁ 절대 가지마세요", "content": "솔직히 말씀드리면... 역삼 ㅁㅁ은 별로예요ㅠ 조건이랑 실제가 다르고 텃세도 심했어요. 참고하세요!"},
    {"title": "논현 ㅂㅂ 찐후기", "content": "논현동 ㅂㅂ 한 달 다녀본 후기입니다. 페이는 괜찮은데 대기실이 좀 좁아요. 분위기는 나쁘지 않았어요!"},
    {"title": "선릉 ㅅㅅ 분위기 좋네요", "content": "선릉역 근처 ㅅㅅ 가봤는데 시설이 깔끔하고 좋았어요. 손님도 매너 있는 편이었어요✨"},
    {"title": "ㅁㅁ 실장님 진짜 좋으심", "content": "여기 실장님 진짜 좋으세요! 신입도 잘 케어해주시고 부담스럽지 않게 해주셔서 감사했어요🙏"},
    {"title": "ㅂㅂ 대기실 시설 좋아요", "content": "ㅂㅂ 대기실 진짜 넓고 좋아요! 개인 락커도 있고 샤워실도 깔끔해요. 시설 중요하신 분들 참고~"},
    {"title": "ㅅㅅ 페이 칼같이 줍니다", "content": "여기 페이 정산 진짜 칼같아요! 밀리는 거 없이 제때 다 받았습니다. 이게 제일 중요하잖아요ㅋㅋ"},
    {"title": "ㅇㅇ 진상 좀 있어요 조심", "content": "ㅇㅇ 다녀봤는데 손님 중에 진상이 좀 있어요ㅠ 실장님이 잘 막아주긴 하는데 참고하세요!"},
    {"title": "강북 쪽에 괜찮은 곳 발견함", "content": "강북 쪽에도 괜찮은 곳 있더라구요! 경쟁이 덜해서 오히려 좋았어요. 나중에 자세히 풀게요~"},
    {"title": "신림 쪽 후기 공유해요", "content": "신림 ㄴㄴ 다녀왔어요. 솔직히 조건은 평타인데 분위기가 좀 무거웠어요... 취향 탈 것 같아요"},
    {"title": "수원 ㅇㅇ 면접 후기", "content": "수원 ㅇㅇ 면접 봤는데 분위기 좋았어요! 실장님도 상냥하시고 조건도 괜찮았어요. 고민 중ㅎㅎ"},
    {"title": "부산 해운대 원정 후기", "content": "부산 해운대까지 원정 다녀왔어요ㅋㅋ 손님들 매너 좋고 페이도 괜찮았어요! 가끔 내려갈 만해요"},
    {"title": "일산 쪽은 다들 어때요?", "content": "일산으로 옮길까 하는데 다녀보신 분? 분위기나 조건 어떤지 궁금해요!"},
    {"title": "부천 ㅂㅂ 솔직 후기", "content": "부천 ㅂㅂ 일주일 해봤는데요, 괜찮았어요. 텃세 없고 언니들 다 친절했어요!"},
    {"title": "홍대 ㅎㅎ 추천해요", "content": "홍대 ㅎㅎ 진짜 좋아요! 젊은 손님 많고 분위기 활기차요. 페이도 만족스러웠어요👍"},
]

# ============================================================
# 지역정보/팁 (TIP) - 꿀팁 공유
# ============================================================
TIP_POSTS = [
    {"title": "강남역 근처 맛집 정리해드림", "content": "언니들 강남역 근처 맛집 정리해봤어요! 1. ㅇㅇ 쌀국수 - 가성비 갑 2. ㅁㅁ 파스타 - 맛있음 3. ㅂㅂ 떡볶이 - 매콤!"},
    {"title": "출퇴근 택시비 아끼는 꿀팁", "content": "언니들 택시비 아끼는 방법 알려드릴게요! 카카오 택시 쿠폰 잘 챙기시고, 합승하면 진짜 많이 아껴져요💡"},
    {"title": "메이크업 샵 추천드려요", "content": "강남 ㅇㅇ 메이크업샵 진짜 잘해요! 가격도 괜찮고 빠르게 해주셔서 출근 전에 딱이에요💄"},
    {"title": "숙취 해소제 이거 진짜 좋음", "content": "언니들 숙취해소제 많이 드시죠? ㅇㅇ이거 진짜 효과 좋아요! 컨디션 회복 빨라요👍"},
    {"title": "다리 부기 빼는 법", "content": "하루종일 서있으면 다리 붓잖아요ㅠ 압박스타킹 신고 자면 진짜 달라요! 그리고 반신욕 추천!"},
    {"title": "면접 합격하는 꿀팁", "content": "면접 볼 때는 1. 밝게 웃기 2. 자신감 있게 3. 깔끔하게! 이 세가지만 기억하세요💪"},
    {"title": "홀복 싸게 사는 곳", "content": "언니들 홀복 어디서 사세요? 동대문 ㅇㅇ 가면 저렴하게 많이 있어요! 종류도 다양해요👗"},
    {"title": "강남 24시 미용실 추천", "content": "밤에 급하게 머리 손봐야 할 때 가는 곳이에요! 강남역 ㅁㅁ 24시간 운영하고 잘해요✂️"},
    {"title": "돈 모으는 방법 공유해요", "content": "저는 월급에서 30%는 무조건 저축해요! 그리고 가계부 쓰면 돈 어디로 새는지 보여요💰"},
    {"title": "피부 관리 어떻게 하시나요?", "content": "피부 관리 루틴 공유해요! 클렌징 꼼꼼히 + 수분크림 + 일주일에 한번 팩! 이렇게 해도 달라져요"},
    {"title": "렌즈 추천해드려요", "content": "자연스러우면서 눈 커보이는 렌즈 찾으시죠? ㅇㅇ 브라운 추천해요! 직경 13.5 정도가 자연스러워요👀"},
    {"title": "구두 발 안 아픈 거 추천", "content": "하루종일 하이힐 신으면 발 아프잖아요ㅠ ㅁㅁ 브랜드 쿠션감 좋아서 추천! 조금 비싸도 가치있어요"},
    {"title": "향수 추천해주세요", "content": "손님들한테 좋은 향 나게 하고 싶은데 추천 있어요? 너무 진하지 않고 은은한 걸로요🌸"},
    {"title": "신용등급 지키는 법", "content": "언니들 신용등급 중요해요! 카드값 제때 내시고, 연체 절대 안 되게 조심하세요. 나중에 뼈아파요ㅠ"},
    {"title": "세금 정리하는 꿀팁", "content": "프리랜서로 신고하면 세금 혜택 있어요! 헷갈리면 세무사 상담 한번 받아보세요. 알면 좋아요💡"},
]

# ============================================================
# 구인구직 (NEWS) - 구인/구직
# ============================================================
NEWS_POSTS = [
    {"title": "강남 최고 페이 보장! 급구합니다", "content": "강남 1등 가게에서 언니들 모셔요! 최고 페이 + 숙식제공 + 당일지급 O 문의 주세요💎"},
    {"title": "역삼 신규 오픈! 언니들 모집", "content": "역삼역 도보 3분거리! 신규 오픈해서 자리 많아요~ 초보환영, 경력우대! 편하게 연락주세요"},
    {"title": "당일 지급 O 숙식 제공 O", "content": "조건 좋은 곳에서 언니들 구해요! 당일 현금 지급, 숙식 가능! 자세한 건 쪽지로 문의주세요🏠"},
    {"title": "초보 환영! 가족같은 분위기", "content": "경력 없어도 괜찮아요~ 친절하게 알려드려요! 텃세 없고 가족같은 분위기에요. 부담 없이 연락주세요💕"},
    {"title": "논현동 급구", "content": "논현동에서 급하게 구해요! 이번 주 바로 가능하신 분! 조건 좋아요. 관심 있으시면 연락주세요"},
    {"title": "선릉 멤버 모집합니다", "content": "선릉역 3분거리! 시설 좋고 분위기 좋은 곳에서 함께 하실 분 구해요. 경력우대, 초보가능!"},
    {"title": "주말 알바 구합니다 (고수익)", "content": "주말만 하실 분 구해요! 평일 본업 있으시고 주말 투잡 찾으시는 분 환영해요. 페이 좋아요💰"},
    {"title": "친구 동반 환영합니다", "content": "친구분이랑 같이 오고 싶으시면 환영해요! 함께 출퇴근하시면 교통비 지원도 해드려요🚗"},
    {"title": "텃세 없음! 케어 확실함", "content": "텃세 싫어하시죠? 저희는 진짜 없어요! 신입도 편하게 적응할 수 있게 케어해드려요👍"},
    {"title": "출퇴근 자유! 편하게 일하세요", "content": "시간 자유롭게 정하실 수 있어요! 본인 스케줄에 맞춰서 출근하시면 돼요. 부담 없이 연락주세요"},
    {"title": "대기실 완비! 개인 락커 지급", "content": "쾌적한 환경에서 일하세요! 넓은 대기실, 개인 락커, 샤워실 완비! 시설 좋은 곳 찾으시는 분 연락주세요"},
    {"title": "성실하신 분 모십니다", "content": "성실하게 일하실 분 찾아요! 경력보다 마인드가 중요해요. 성장 가능성 있는 분 환영!"},
    {"title": "단기 알바 가능합니다", "content": "한 달, 두 달 단기 알바 가능해요! 장기 전환도 가능하니 부담 없이 시작하세요"},
    {"title": "대학생/투잡 환영합니다", "content": "학교 다니시면서 투잡 하시는 분? 시간 맞춰드릴게요! 저녁 시간대 가능하신 분 연락주세요📚"},
    {"title": "강북 쪽 구인합니다", "content": "강북 쪽에서 일하실 분 구해요! 경쟁 덜하고 분위기 편해요. 궁금하신 점 있으시면 문의주세요"},
]

def login():
    """관리자 로그인하여 토큰 획득"""
    try:
        response = requests.post(f"{API_BASE_URL}/auth/login", json={
            "email": ADMIN_EMAIL,
            "password": ADMIN_PASSWORD
        }, timeout=10)
        response.raise_for_status()
        data = response.json()
        if data.get('data') and data['data'].get('accessToken'):
            return data['data']['accessToken']
        else:
            print(f"로그인 응답 구조 오류: {data}")
            return None
    except Exception as e:
        print(f"로그인 실패: {e}")
        return None

def create_post(token, category_frontend, title, content):
    """게시글 생성 API 호출"""
    category_backend = CATEGORY_MAP.get(category_frontend, 'FREE')
    author = random.choice(AUTHOR_NAMES)
    
    data = {
        "category": category_backend,
        "title": title,
        "content": content,
        "authorName": author,
        "password": "1234"
    }
    
    headers = {"Authorization": f"Bearer {token}"}
    
    try:
        response = requests.post(f"{API_BASE_URL}/community/posts", json=data, headers=headers, timeout=10)
        if response.status_code == 201:
            return True
        else:
            print(f"작성 실패 ({response.status_code}): {response.text[:100]}")
            return False
    except Exception as e:
        print(f"에러 발생: {e}")
        return False

def main():
    print("🚀 커뮤니티 데이터 주입 시작...")
    print(f"📡 API 서버: {API_BASE_URL}")
    
    token = login()
    if not token:
        print("❌ 로그인 실패! 백엔드 서버가 실행 중인지 확인하세요.")
        return

    print("✅ 로그인 성공!\n")

    total_created = 0
    
    # 카테고리별 게시글 생성
    categories_data = [
        ("자유게시판", FREE_POSTS),
        ("질문답변", QNA_POSTS),
        ("업소후기", REVIEW_POSTS),
        ("지역정보", TIP_POSTS),
        ("구인구직", NEWS_POSTS),
    ]
    
    for category, posts in categories_data:
        print(f"\n📂 [{category}] 게시글 생성 중...")
        count = 0
        
        # 각 게시글 등록 (기본 게시글 15개 + 변형 10개 = 25개씩)
        for post in posts:
            if create_post(token, category, post["title"], post["content"]):
                count += 1
                total_created += 1
            time.sleep(0.05)  # API 부하 방지
        
        # 변형 게시글 추가 (다양성 확보)
        for i in range(10):
            original = random.choice(posts)
            varied_title = original["title"] + f" {random.randint(1, 99)}"
            if create_post(token, category, varied_title, original["content"]):
                count += 1
                total_created += 1
            time.sleep(0.05)
        
        print(f"✅ [{category}] 완료: {count}개")

    print(f"\n✨ 총 {total_created}개 게시글 생성 완료!")

if __name__ == "__main__":
    main()
