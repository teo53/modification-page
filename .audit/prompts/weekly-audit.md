# 주간 감사 프롬프트

매주 1회 전체 프로젝트를 점검하는 프롬프트.
일요일 또는 한 주 개발 완료 후 사용 권장.

---

## 사용 시점

- 매주 일요일 (권장)
- 한 주간 개발 작업 완료 후
- 중요한 기능 여러 개 추가 후

---

## 프롬프트 (복사해서 Claude Code에 붙여넣기)

```
주간 전체 프로젝트 감사해줘.
나는 비개발자라서 코드 판단 못함.
이번 주에 뭘 수정했는지 기억 못해도 전체 훑어봐줘.

## 감사 범위

### 1. 보안 (CRITICAL) - 필수
```
pages/api/auth/**
pages/api/payment/**
app/api/auth/**
app/api/payment/**
lib/db/**
lib/supabase/**
middleware.ts
```

### 2. API 전체 (HIGH) - 필수
```
pages/api/**
app/api/**
```

### 3. 주요 로직 (MEDIUM) - 훑어보기
```
lib/**
hooks/**
contexts/**
```

## 체크리스트

### 보안
- [ ] SQL Injection 취약점
- [ ] XSS 취약점
- [ ] CSRF 보호
- [ ] 인증 우회 가능성
- [ ] 인가 우회 가능성
- [ ] API Key/Password 하드코딩
- [ ] 민감정보 로깅
- [ ] Rate Limiting

### 기능 완전성
- [ ] 모든 API 엔드포인트가 실제 존재하는가
- [ ] 프론트에서 호출하는 API 경로가 맞는가
- [ ] 필수 필드 검증이 있는가
- [ ] 에러 응답이 일관적인가

### 데이터 흐름
- [ ] 프론트 → API → DB 경로가 완전한가
- [ ] 응답 데이터 타입이 프론트 기대와 일치하는가
- [ ] 에러 상황에서 적절히 처리되는가

### 코드 품질
- [ ] 사용하지 않는 코드/import
- [ ] TODO/FIXME 미해결 항목
- [ ] console.log 남아있는 것
- [ ] 중복 코드

## 요청사항

1. **우선순위 정리**: CRITICAL → HIGH → MEDIUM 순서로

2. **문제 발견 시**: 
   - 직접 수정해줘
   - 뭘 바꿨는지 쉬운 말로 설명
   - 왜 위험했는지 구체적으로

3. **점수 매기기**: 
   - 보안: X/10
   - 기능: X/10
   - 코드품질: X/10
   - 전체: X/10

4. **다음 주 우선 해결 목록**: TOP 3 뽑아줘

결과를 이 형식으로:

---

## 📊 주간 감사 리포트

**프로젝트**: [프로젝트명]
**감사일**: [오늘 날짜]
**검사 파일 수**: [숫자]

### 📈 점수

| 항목 | 점수 | 상태 |
|------|------|------|
| 보안 | X/10 | 🟢/🟡/🔴 |
| 기능 | X/10 | 🟢/🟡/🔴 |
| 코드품질 | X/10 | 🟢/🟡/🔴 |
| **전체** | **X/10** | |

### 🚨 CRITICAL 이슈 (즉시 수정)

#### 1. [이슈명]
- **파일**: [경로]
- **위험**: [설명]
- **수정**: [완료/필요]

### ⚠️ HIGH 이슈 (이번 주 내 수정)

#### 1. [이슈명]
- **파일**: [경로]
- **설명**: [내용]

### 📝 MEDIUM 이슈 (개선 권장)

- [이슈 1]
- [이슈 2]

### ✅ 잘된 점

- [좋은 점 1]
- [좋은 점 2]

### 📋 다음 주 우선 해결 목록

1. **[가장 중요]**: [설명]
2. **[두 번째]**: [설명]
3. **[세 번째]**: [설명]

### 🧪 권장 테스트

1. [테스트 1]
2. [테스트 2]

---
```

---

## 예시 출력

```
## 📊 주간 감사 리포트

**프로젝트**: QueenAlba
**감사일**: 2024-01-14
**검사 파일 수**: 47개

### 📈 점수

| 항목 | 점수 | 상태 |
|------|------|------|
| 보안 | 7/10 | 🟡 |
| 기능 | 8/10 | 🟢 |
| 코드품질 | 6/10 | 🟡 |
| **전체** | **7/10** | |

### 🚨 CRITICAL 이슈 (즉시 수정)

#### 1. API Key 하드코딩
- **파일**: lib/payment/toss.ts:15
- **위험**: TossPayments 시크릿 키가 코드에 직접 있음. GitHub에 올라가면 결제 도용 가능
- **수정**: ✅ 완료 - .env로 이동함

### ⚠️ HIGH 이슈 (이번 주 내 수정)

#### 1. 결제 금액 검증 누락
- **파일**: pages/api/payment/confirm.ts
- **설명**: 프론트에서 보낸 금액을 그대로 사용. 해커가 금액을 조작해서 1원에 구매 가능

#### 2. 에러 메시지에 스택트레이스
- **파일**: pages/api/auth/login.ts
- **설명**: 에러 발생 시 내부 정보가 사용자에게 노출됨

### 📝 MEDIUM 이슈 (개선 권장)

- console.log 23개 남아있음 (pages/api 폴더)
- TODO 주석 5개 미해결
- 중복된 인증 체크 로직 3곳

### ✅ 잘된 점

- Supabase RLS 정책 잘 적용됨
- JWT 토큰 검증 일관적
- API 응답 형식 통일됨

### 📋 다음 주 우선 해결 목록

1. **결제 금액 서버 검증**: DB에서 실제 금액 조회해서 비교하는 로직 추가
2. **에러 핸들링 통일**: 프로덕션에서는 상세 에러 숨기기
3. **console.log 정리**: 배포 전 제거

### 🧪 권장 테스트

1. 결제 테스트: 개발자 도구로 금액 변조해보기
2. 로그인 실패: 일부러 에러 내서 메시지 확인
3. 권한 테스트: 다른 사용자 데이터 접근 시도
```
